# Bgtasker - 后台任务 {#guide-bgtasker}

有时在用户操作应用程序的过程中会出现耗时很长的操作，这时可以弹出一个对话框让用户等待操作完成，虽然这么避免了界面失去响应，但组织了用户在界面上进行其它操作，这时就可以将这个操作交给后台任务服务托管。

要发布一个任务，使用 Bgtasker 上的 post 方法，并传入一个接受 `TaskEntry&` 类型参数的函数对象，以及任务标题：

```cpp
Application::bgtasker().post([](TaskEntry& te){
  while (!te.canceled()) {
    // ...
  }
}, "任务示例");
```

这将在后台任务面板中显示一个任务：

![](bgtask_example.png)

和 Notifier 一样，**Bgtasker 也是线程安全的**，你可以从任何线程中发布任务，提交的任务将在全局默认的线程池中执行。

## 任务条目对象

TaskEntry 对象用于任务线程对外报告任务进度，以及检查用户是否取消了任务。函数对象可以通过 TaskEntry 上的 set_progress 方法设置界面上显示的进度条，通过 set_status 方法设置任务的状态文本等。

要启用可设置进度的进度条，在调用 post 方法时设置第三和第四个参数，要启用取消按钮，将第五个设置为 true，你也可以在函数对象中修改这些配置。
